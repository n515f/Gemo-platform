/* ================= Header (Glass • Sticky) ================ */
:root{
  --dur:.28s; --dur-fast:.16s; --easing:cubic-bezier(.22,.61,.36,1);
  --glass: color-mix(in srgb, var(--bg, #fff) 72%, transparent);
  --glass-border: color-mix(in srgb, var(--fg, #0f172a) 12%, transparent);
}

.topbar{ position:sticky; top:0; z-index:999;
  background:linear-gradient(180deg,
    color-mix(in srgb, var(--bg) 26%, transparent) 0%,
    color-mix(in srgb, var(--bg) 10%, transparent) 100%);
  -webkit-backdrop-filter:saturate(160%) blur(12px);
  backdrop-filter:saturate(160%) blur(12px);
}
.topbar::after{ content:""; position:absolute; inset:auto 0 0; height:1px;
  background:var(--glass-border); opacity:.35; transform:scaleY(0);
  transform-origin:bottom; transition:transform var(--dur-fast) var(--easing),opacity var(--dur-fast) var(--easing);
}
.topbar.scrolled::after{ transform:scaleY(1); opacity:.8; }

.topbar .shell{ display:flex; align-items:center; gap:16px;
  width:min(1200px,94%); margin-inline:auto; padding:12px 0;
}

/* ---------- RTL/LTR ---------- */
html[dir="rtl"] .right-logo{ order:0; }  html[dir="rtl"] .center-nav{ order:1; }  html[dir="rtl"] .user-actions{ order:2; }
html[dir="ltr"] .right-logo{ order:0; }  html[dir="ltr"] .center-nav{ order:1; }  html[dir="ltr"] .user-actions{ order:2; }

/* ---------- Logo / Brand ---------- */
.brand-left{ display:flex; align-items:center; gap:12px; min-width:230px; }
.right-logo .brand-logo-link{ display:inline-flex; align-items:center; }
.logo-big{ width:56px; height:56px; object-fit:contain; background:transparent; border:0; display:block; }
.only-desktop{ display:inline-flex; align-items:center; gap:12px; min-width:220px; }
.brand-text{ display:flex; flex-direction:column; line-height:1; min-width:0; }
.brand-text .title{ font-weight:900; letter-spacing:.2px; }
.brand-text .tagline{ color:var(--muted); font-weight:700; margin-top:2px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.brand-text .email{ direction:ltr; unicode-bidi:embed; color:var(--muted); font-weight:700; }

/* ---------- Nav (desktop) ---------- */
.topnav{ flex:1 1 auto; display:flex; align-items:center; justify-content:space-between; gap:10px; min-height:56px; }
.center-nav{ display:flex; justify-content:center; flex:1; }
.desktop-nav{ display:flex; align-items:center; gap:8px; padding:4px; border-radius:16px;
  border:1px solid var(--glass-border); background:color-mix(in srgb, var(--fg) 6%, transparent);
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--bg) 2%, transparent);
}
.desktop-nav .pill{ display:inline-flex; align-items:center; padding:10px 16px; border-radius:14px;
  text-decoration:none; font-weight:900; white-space:nowrap; color:var(--muted);
  transition:color var(--dur-fast) var(--easing), background var(--dur-fast) var(--easing), transform var(--dur-fast) var(--easing);
}
.desktop-nav .pill:hover{ color:var(--primary); transform:translateY(-1px); }
.desktop-nav .pill.active{ background:color-mix(in srgb, var(--fg) 6%, transparent); color:var(--text); box-shadow:inset 0 0 0 1px var(--glass-border); }
.dark .desktop-nav{ background:rgba(255,255,255,.05); }
.dark .desktop-nav .pill.active{ background:rgba(255,255,255,.06); }

/* ---------- Right actions ---------- */
.user-actions{ display:flex; align-items:center; gap:10px; }
.pill{ display:inline-flex; align-items:center; padding:10px 16px; border-radius:14px; text-decoration:none; font-weight:900; }
.pill.cta{ background:var(--grad-brand); color:#0b1220; box-shadow:0 10px 20px rgba(2,6,23,.10); }
.pill.cta:hover{ filter:brightness(1.05); transform:translateY(-1px); }

.theme-btn{ display:inline-grid; place-items:center; width:42px; height:42px; border-radius:12px;
  border:1px solid var(--glass-border); background:var(--glass); }
.clean-btn{ border:none!important; background:transparent!important; box-shadow:none!important; padding:8px; transition:opacity .2s ease; }
.clean-btn:hover{ opacity:.8; }

.user-photo,.manager-img{ width:42px; height:42px; border-radius:50%; object-fit:cover; border:none!important; box-shadow:none!important; }

.logout-form{ margin:0; padding:0; }
.logout-btn{ background:transparent; border:none; padding:4px; display:inline-flex; align-items:center; justify-content:center; cursor:pointer; }
.logout-btn svg{ display:block; }

/* ---------- Hamburger (mobile only) ---------- */
.hamburger{ display:none; flex-direction:column; justify-content:center;
  width:38px; height:38px; border:none; border-radius:10px; background:rgba(255,255,255,0.12);
  cursor:pointer; transition:all .25s ease;
}
.hamburger span{ height:2px; border-radius:2px; background:var(--fg); margin:3px 0; width:22px; transition:transform .25s ease, opacity .25s ease; }
.hamburger:hover{ background:rgba(255,255,255,0.2); }
.hamburger.open span:nth-child(1){ transform:translateY(5px) rotate(45deg); }
.hamburger.open span:nth-child(2){ opacity:0; }
.hamburger.open span:nth-child(3){ transform:translateY(-5px) rotate(-45deg); }

/* ---------- Mobile menu ---------- */
.mobile-menu{ position:absolute; inset-inline:10px; top:calc(100% + 8px);
  background:var(--card); border:1px solid var(--ring); border-radius:14px; box-shadow:var(--shadow-lg);
  padding:8px; display:flex; flex-direction:column; gap:6px; z-index:60;
}
.mobile-user{ display:flex; align-items:center; gap:10px; padding:.6rem .8rem; margin-bottom:6px; border-radius:12px; background:var(--soft); border:1px solid var(--ring); }
.mobile-user img{ width:42px; height:42px; border-radius:50%; object-fit:cover; }
.mobile-user .name{ font-weight:900; }
.mobile-user .email{ color:var(--muted); font-weight:700; max-width:58vw; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.mobile-user .email.ltr{ direction:ltr; unicode-bidi:embed; }

.mobile-menu .item{ display:block; padding:.75rem .95rem; border-radius:10px; font-weight:800; color:var(--fg);
  text-decoration:none; border:1px solid transparent; transition:background var(--dur-fast) var(--easing); }
.mobile-menu .item:hover{ background:color-mix(in srgb, var(--fg) 5%, transparent); }
.mobile-menu .item.start{ background:var(--grad-brand); color:#0b1220; text-align:center; }
.mobile-menu .item.danger{ background:#fee2e2; color:#991b1b; font-weight:900; text-align:center; }
.row-split{ display:flex; align-items:center; justify-content:space-between; gap:10px; }

/* ---------- Responsive (shared) ---------- */
.md-only{ display:none; }
@media (max-width:992px){
  .desktop-nav{ display:none !important; }
  .only-desktop{ display:none !important; }
  .md-only{ display:inline-flex !important; }
  .hamburger{ display:inline-flex !important; }
  .user-chip{ display:inline-flex; }
  .topbar .shell{ gap:10px; }
}
@media (max-width:640px){
  .topbar .shell{ padding:10px 0; }
  .brand-left{ min-width:180px; }
}

/* ===== شريحة المستخدم في الموبايل داخل الشريط ===== */
.user-chip{
  display:none; align-items:center; gap:0; padding:0;
  border:0 !important; background:transparent !important;
  box-shadow:none !important; border-radius:0; cursor:pointer;
}
.user-chip:hover,.user-chip:focus{ background:transparent; box-shadow:none; outline:none; }
.user-chip .chip-avatar{ width:28px; height:28px; border-radius:50%; object-fit:cover; display:block; }
.user-chip .chip-name{ font-weight:900; line-height:1; max-width:34vw; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.chip-logout{ margin:0; }
.chip-logout button{ background:transparent; border:none; padding:4px; display:inline-grid; place-items:center; cursor:pointer; }

/* =========== Avatar Modal (Backdrop Blur) =========== */
.avatar-backdrop{
  position:fixed; inset:0; z-index:1100; background:rgba(0,0,0,.45);
  -webkit-backdrop-filter: blur(8px); backdrop-filter: blur(8px);
  display:grid; place-items:center;
}
.avatar-modal{
  width:min(96vw, 520px); border-radius:16px; background:var(--card, #fff); color:var(--fg);
  border:1px solid var(--ring); box-shadow:0 30px 60px rgba(0,0,0,.28); overflow:hidden; display:flex; flex-direction:column;
}
.dark .avatar-modal{ background:color-mix(in srgb, var(--card) 88%, #000 12%); }
.avatar-modal-header{ display:flex; align-items:center; justify-content:flex-start; padding:10px 12px; border-bottom:1px solid var(--ring); }
.avatar-back-btn{ display:inline-flex; align-items:center; gap:8px; background:transparent; border:1px solid var(--ring);
  padding:8px 10px; border-radius:10px; font-weight:800; cursor:pointer; }
.avatar-modal-body{ padding:12px; }
.avatar-preview{ width:100%; aspect-ratio:1 / 1; object-fit:cover; border-radius:12px; display:block; }
.avatar-actions{ display:flex; align-items:center; gap:10px; padding:12px; border-top:1px solid var(--ring); flex-wrap:wrap; }
.avatar-action-btn{
  display:inline-flex; align-items:center; gap:8px; padding:10px 12px; border-radius:12px; font-weight:900;
  background:var(--soft); border:1px solid var(--ring); cursor:pointer; text-decoration:none; color:var(--fg);
}
.avatar-action-btn input.sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0; }
.avatar-action-btn.danger{ background:#fee2e2; border-color:#fecaca; color:#991b1b; }
.avatar-action-btn:hover{ filter:brightness(.98); transform:translateY(-1px); transition:transform .15s var(--easing), filter .15s var(--easing); }

/* ---- Keep topbar in one line ---- */
.topbar .shell{
  display:flex; align-items:center; gap:12px;
  width:min(1200px,94%); margin-inline:auto; padding:12px 0; flex-wrap:nowrap;
}

/* Logo / brand tweaks */
.brand-left{ display:flex; align-items:center; gap:10px; min-width:0; flex:0 1 auto; }
.only-desktop{ display:inline-flex; align-items:center; gap:8px; min-width:0; }
.brand-text{ display:flex; flex-direction:column; line-height:1; min-width:0; max-width:24ch; }
.brand-text--user{ max-width:26ch; }
.title--clip{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.email--clip{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

/* وسط الشريط يتمدّد */
.topnav{ flex:1 1 auto; display:flex; align-items:center; justify-content:space-between; gap:10px; min-height:56px; min-width:0; }
.center-nav{ flex:1 1 50%; display:flex; justify-content:center; min-width:0; overflow:hidden; }
.desktop-nav::-webkit-scrollbar{ display:none; }

/* بيانات المستخدم على اليمين لا تكسر السطر */
.user-actions{ display:flex; align-items:center; gap:10px; flex:0 0 auto; min-width:0; }

/* أيقونة افتراضية بدلاً من الصورة */
.user-photo.user-photo--icon, .chip-avatar--icon{
  width:42px; height:42px; border-radius:50%; display:grid; place-items:center;
  border:1px solid var(--glass-border);
  background:color-mix(in srgb, var(--fg) 6%, transparent);
}
.chip-avatar--icon{ width:28px; height:28px; }
.user-photo.user-photo--icon svg, .chip-avatar--icon svg{ width:70%; height:70%; display:block; }

/* قلّل الـ min-width للشعار حتى لا يدفع الوسط */
.logo-big{ width:48px; height:48px; object-fit:contain; }

/* ==== Mobile: Logo first, spacer, user-actions, Hamburger last ==== */
@media (max-width: 992px){
  .topbar .shell{ flex-wrap: nowrap; gap: 10px; }

  /* 1) الشعار أولاً */
  .right-logo  { order: 1; }

  /* 2) الروابط تعمل كفراغ يتمدّد في الوسط */
  .topnav      { order: 2; flex: 1 1 auto; min-width: 0; }

  /* 3) صورة المستخدم + اللغة + الثيم بمحاذاة الطرف */
  .user-actions{
    order: 3;
    flex: 0 0 auto;
    margin-inline-start: auto;
    gap: 8px;
  }

  /* 4) زر الهمبرغر في الطرف الآخر (الأخير) */
  .right-logo   { order: 4; }

  /* تحسين مقاسات الأزرار في الموبايل */
  .user-actions .theme-btn{ width:36px; height:36px; border-radius:10px; }
  .user-actions .pill.clean-btn{ padding:8px 10px; }
  .user-chip .chip-avatar, .chip-avatar--icon{ width:30px; height:30px; }
}
/* ===== User dropdown (desktop) ===== */
.avatar-wrap{ position:relative; display:inline-flex; align-items:center; gap:10px; border:0; background:transparent; cursor:pointer; }
.user-menu{
  position:absolute;
  inset-inline-start:0; inset-block-start:calc(100% + 8px);
  min-width:200px;
  background:var(--card, #fff);
  border:1px solid var(--ring, #e5e7eb);
  border-radius:12px;
  box-shadow:0 20px 40px rgba(0,0,0,.14);
  padding:6px;
  z-index:1000;
}
[dir="rtl"] .user-menu{ inset-inline-start:auto; inset-inline-end:0; }
.user-menu__item{
  display:block; width:100%;
  padding:.65rem .8rem; border-radius:10px;
  text-align:inherit; text-decoration:none;
  font-weight:800; color:var(--fg, #0f172a);
  border:1px solid transparent;
}
.user-menu__item:hover{ background:color-mix(in srgb, var(--fg) 6%, transparent); }
.user-menu__item--danger{ color:#991b1b; background:#fee2e2; border-color:#fecaca; }
.user-menu__item--danger:hover{ filter:brightness(.98); }
.dark .user-menu{ background:color-mix(in srgb, var(--card, #0f172a) 92%, #000 8%); border-color:var(--ring, #1f2937); }
/* ---------- Logo / Brand ---------- */
.brand-left{ display:flex; align-items:center; gap:12px; min-width:230px; }
.right-logo .brand-logo-link{ display:inline-flex; align-items:center; }
.logo-big{ width:56px; height:56px; object-fit:contain; background:transparent; border:0; display:block; }
.only-desktop{ display:inline-flex; align-items:center; gap:12px; min-width:220px; }

/* النص بجانب الصورة — محاذاة حسب الاتجاه، بدون توسيط */
.brand-text{
  display:flex; flex-direction:column; line-height:1; min-width:0;
  /* المهم هنا: */
  text-align:start;               /* يحترم RTL/LTR تلقائياً */
  align-items:flex-start;         /* يلغي أي توسيط عمودي */
}

/* مساحة منطقية بين الصورة والنص حسب الاتجاه */
.avatar-wrap .brand-text,
.avatar-wrap .brand-text--user{
  margin-inline-start:10px;       /* LTR: margin-left, RTL: margin-right */
  margin-inline-end:0;
}

/* على الموبايل (chip) لو احتجت نفس المسافة */
.user-chip + .brand-text,
.user-chip-wrap .brand-text{
  margin-inline-start:8px;
}

/* اسم المستخدم وإيميله لا يتوسطان */
.brand-text .title,
.brand-text--user .title{ 
  font-weight:900; letter-spacing:.2px;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  text-align:start;
}
.brand-text .email,
.brand-text--user .email{
  color:var(--muted); font-weight:700;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  text-align:start;
}

/* إجبار الإيميل أن يُعرض LTR لكن تبقى المحاذاة start */
.brand-text .email,
.brand-text--user .email{
  direction:ltr; unicode-bidi:embed;
}

/* لو كنت تستعمل الكلاسات المساعدة القديمة */
.brand-text--user{ max-width:26ch; }
.title--clip{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; text-align:start; }
.email--clip{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; text-align:start; }

/* دعم صريح إن احتجت تخصيصاً للـ RTL */
[dir="rtl"] .avatar-wrap .brand-text{ 
  margin-inline-start:0; 
  margin-inline-end:10px; 
}
/* SVG icons used in topbar buttons */
.theme-btn .ico,
.clean-btn .ico,
.logout-btn svg,
.icon-btn .ico {
  width: 18px;
  height: 18px;
  display: block;
  color: currentColor;
  stroke: currentColor;
  stroke-width: 2;
  fill: none;
  vector-effect: non-scaling-stroke;
}


/* ---------- Responsive ---------- */
@media (max-width:992px){
  .desktop-nav{ display:none !important; }
  .topbar .shell{ gap:10px; }
  .user-actions .theme-btn{ width:36px; height:36px; border-radius:10px; }
  .clean-btn.pill{ padding:8px 10px; }
  .logo-big{ width:44px; height:44px; }
}
@media (max-width:640px){
  .topbar .shell{ padding:10px 0; }
}